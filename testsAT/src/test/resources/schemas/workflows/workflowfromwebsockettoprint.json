{
  "id": "b0fa49ee-eca4-42ba-97da-e539c68ebc15",
  "name": "workflowfromwebsockettoprint",
  "description": "workflowfromwebsockettoprint",
  "settings": {
    "global": {
      "executionMode": "marathon",
      "streamTemporalTable": "stream",
      "driverUri": "/opt/sds/sparta/driver/sparta-driver.jar",
      "userPluginsJars": [
        {
          "jarPath": ""
        }
      ],
      "initSqlSentences": [
        {
          "sentence": ""
        }
      ]
    },
    "checkpointSettings": {
      "checkpointPath": "sparta/checkpoint",
      "enableCheckpointing": true,
      "autoDeleteCheckpoint": true,
      "addTimeToCheckpointPath": false
    },
    "streamingSettings": {
      "window": "6s"
    },
    "sparkSettings": {
      "master": "mesos://leader.mesos:5050",
      "sparkKerberos": false,
      "sparkHome": "/opt/spark/dist",
      "submitArguments": {
        "userArguments": [
          {
            "submitArgument": "",
            "submitValue": ""
          }
        ],
        "deployMode": "client",
        "supervise": false
      },
      "sparkConf": {
        "sparkResourcesConf": {
          "coresMax": "1",
          "executorMemory": "1G",
          "executorCores": "1",
          "driverCores": "1",
          "driverMemory": "1G",
          "localityWait": "0",
          "taskMaxFailures": "8",
          "blockInterval": "200ms"
        },
        "sparkDockerConf": {
          "executorDockerImage": "qa.stratio.com/stratio/stratio-spark:2.1.0.1",
          "executorDockerVolumes": "/opt/mesosphere/packages/:/opt/mesosphere/packages/:ro,/opt/mesosphere/lib/:/opt/mesosphere/lib/:ro",
          "executorForcePullImage": false
        },
        "sparkMesosConf": {
          "mesosNativeJavaLibrary": "/opt/mesosphere/lib/libmesos.so",
          "mesosExecutorHome": "/opt/spark/dist"
        },
        "userSparkConf": [
          {
            "sparkConfKey": "",
            "sparkConfValue": ""
          }
        ],
        "coarse": true,
        "stopGracefully": true,
        "parquetBinaryAsString": true
      }
    }
  },
  "transformations": {
    "transformationsPipe": [
      {
        "type": "Json",
        "order": 0,
        "inputField": "_attachment_body",
        "outputFields": [
          {
            "name": "response",
            "type": "string"
          }
        ],
        "configuration": {
          "queries": [
            {
              "field": "response",
              "query": "$.response"
            }
          ],
          "supportNullValues": true,
          "whenError": "Error",
          "removeInputField": false
        }
      }
    ]
  },
  "streamTriggers": [
    {
      "name": "response",
      "sql": "select * from stream",
      "writer": {
        "outputs": [
          "postgres"
        ],
        "autoCalculatedFields": [],
        "saveMode": "Append"
      },
      "overLast": "6s",
      "configuration": {},
      "computeEvery": "6s"
    }
  ],
  "cubes": [
    {
      "name": "cube1",
      "dimensions": [
        {
          "name": "response",
          "field": "response",
          "precision": "identity",
          "type": "Default"
        }
      ],
      "operators": [
        {
          "type": "Count",
          "name": "count",
          "configuration": {}
        }
      ],
      "writer": {
        "outputs": [
          "print"
        ],
        "dateType": "timestamp",
        "autoCalculatedFields": [],
        "saveMode": "Upsert"
      },
      "triggers": [],
      "configuration": {}
    }
  ],
  "input": {
    "name": "websocket",
    "type": "WebSocket",
    "configuration": {
      "url": "ws://stream.meetup.com/2/rsvps",
      "storageLevel": "MEMORY_ONLY_SER"
    }
  },
  "outputs": [
    {
      "name": "print",
      "type": "Print",
      "configuration": {
        "printMetadata": false,
        "printData": true,
        "printSchema": true,
        "logLevel": "warn"
      }
    },
    {
      "name": "postgres",
      "type": "Postgres",
      "configuration": {
        "url": "jdbc:postgresql://pg_0001-postgressec.service.paas.labs.stratio.com:1027/postgres?user=sparta&ssl=true&sslmode=verify-full&sslcert=/tmp/cert.crt&sslrootcert=/tmp/caroot.crt&sslkey=/tmp/key.pkcs8",
        "postgresSaveMode": "STATEMENT",
        "batchsize": "",
        "isolationLevel": "READ_UNCOMMITTED",
        "driver": "",
        "caName": "ca",
        "bufferSize": "65536",
        "tlsEnable": true,
        "saveOptions": [
          {
            "saveOptionsValue": "",
            "saveOptionsKey": ""
          }
        ],
        "numPartitions": ""
      }
    }
  ],
  "fragments": []
}