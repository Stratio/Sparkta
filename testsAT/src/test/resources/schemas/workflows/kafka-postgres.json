{
  "id": "56d54069-6844-4131-927b-4321a77fa9ed",
  "name": "kafka-postgres",
  "description": "Automatic Workflow kafka-postgres",
  "settings": {
    "global": {
      "executionMode": "marathon",
      "userPluginsJars": [],
      "initSqlSentences": [],
      "addAllUploadedPlugins": true,
      "mesosConstraint": "",
      "mesosConstraintOperator": "CLUSTER"
    },
    "streamingSettings": {
      "window": "10s",
      "remember": "",
      "backpressure": false,
      "blockInterval": "100ms",
      "stopGracefully": false,
      "checkpointSettings": {
        "checkpointPath": "sparta/checkpoint",
        "enableCheckpointing": true,
        "autoDeleteCheckpoint": true,
        "addTimeToCheckpointPath": false
      }
    },
    "sparkSettings": {
      "master": "mesos://leader.mesos:5050",
      "sparkKerberos": true,
      "sparkDataStoreTls": true,
      "sparkMesosSecurity": true,
      "submitArguments": {
        "userArguments": [],
        "deployMode": "client",
        "driverJavaOptions": "-Dconfig.file=/etc/sds/sparta/spark/reference.conf -XX:+UseConcMarkSweepGC -Dlog4j.configurationFile=file:///etc/sds/sparta/log4j2.xml"
      },
      "sparkConf": {
        "sparkResourcesConf": {
          "coresMax": "1",
          "executorMemory": "2G",
          "executorCores": "1",
          "driverCores": "1",
          "driverMemory": "2G",
          "mesosExtraCores": "",
          "localityWait": "100",
          "taskMaxFailures": "8",
          "sparkMemoryFraction": "0.6",
          "sparkParallelism": ""
        },
        "userSparkConf": [],
        "coarse": true,
        "sparkUser": "",
        "sparkLocalDir": "/opt/spark/dist",
        "executorDockerImage": "qa.stratio.com/stratio/stratio-spark:2.2.0.5",
        "sparkKryoSerialization": false,
        "sparkSqlCaseSensitive": false,
        "logStagesProgress": false,
        "hdfsTokenCache": false,
        "executorExtraJavaOptions": "-XX:+UseConcMarkSweepGC"
      }
    },
    "errorsManagement": {
      "genericErrorManagement": {
        "whenError": "Error"
      },
      "transformationStepsManagement": {
        "whenError": "Error",
        "whenRowError": "RowError",
        "whenFieldError": "FieldError"
      },
      "transactionsManagement": {
        "sendToOutputs": [],
        "sendStepData": false,
        "sendPredecessorsData": false,
        "sendInputData": true
      }
    }
  },
  "pipelineGraph": {
    "nodes": [
      {
        "name": "Kafka",
        "stepType": "Input",
        "className": "KafkaInputStep",
        "classPrettyName": "Kafka",
        "arity": [
          "NullaryToNary"
        ],
        "writer": {
          "saveMode": "Append",
          "tableName": "",
          "partitionBy": "",
          "errorTableName": ""
        },
        "uiConfiguration": {
          "position": {
            "x": 289,
            "y": 172
          }
        },
        "configuration": {
          "spark.streaming.kafka.consumer.poll.ms": "10000",
          "locationStrategy": "preferconsistent",
          "inputOptions": "[]",
          "topics": [
            {
              "topic": "idtopic"
            }
          ],
          "auto.offset.reset": "latest",
          "partition.assignment.strategy": "range",
          "value.deserializer.inputFormat": "JSON",
          "tlsEnabled": true,
          "spark.streaming.kafka.consumer.cache.enabled": false,
          "group.id": "sparta_2",
          "bootstrap.servers": [
            {
              "host": "broker-0001.kafka-sec.mesos",
              "port": "9092"
            }
          ],
          "enable.auto.commit": false,
          "value.deserializer.json.schema.fromRow": true,
          "storeOffsetInKafka": true
        },
        "supportedEngines": [],
        "executionEngine": "Streaming"
      },
      {
        "name": "tabletest",
        "stepType": "Transformation",
        "className": "TriggerTransformStepStreaming",
        "classPrettyName": "Trigger",
        "arity": [
          "BinaryToNary",
          "UnaryToNary"
        ],
        "writer": {
          "saveMode": "Append",
          "tableName": "",
          "partitionBy": ""
        },
        "uiConfiguration": {
          "position": {
            "x": 729,
            "y": 322
          }
        },
        "configuration": {
          "sql": "select id from Kafka"
        },
        "supportedEngines": [],
        "executionEngine": "Streaming"
      },
      {
        "name": "Postgres",
        "stepType": "Output",
        "className": "PostgresOutputStep",
        "classPrettyName": "Postgres",
        "arity": [
          "NullaryToNullary",
          "NaryToNullary"
        ],
        "writer": {
          "saveMode": "Append"
        },
        "uiConfiguration": {
          "position": {
            "x": 972,
            "y": 204
          }
        },
        "configuration": {
          "errorSink": false,
          "url": "jdbc:postgresql://pg-0001.postgrestls.mesos:5432/postgres?user=sparta-server",
          "postgresSaveMode": "STATEMENT",
          "batchsize": "1000",
          "isolationLevel": "READ_UNCOMMITTED",
          "tlsEnabled": true,
          "driver": "",
          "schemaFromDatabase": false,
          "saveOptions": "[]"
        },
        "supportedEngines": [],
        "executionEngine": "Streaming"
      },
      {
        "name": "Print",
        "stepType": "Output",
        "className": "PrintOutputStep",
        "classPrettyName": "Print",
        "arity": [
          "NaryToNullary"
        ],
        "writer": {
          "saveMode": "Append"
        },
        "uiConfiguration": {
          "position": {
            "x": 464,
            "y": -25
          }
        },
        "configuration": {
          "printSchema": true,
          "logLevel": "warn",
          "printMetadata": true,
          "printData": true
        },
        "supportedEngines": [],
        "executionEngine": "Streaming"
      },
      {
        "name": "Cube",
        "stepType": "Transformation",
        "className": "CubeTransformStep",
        "classPrettyName": "Cube",
        "arity": [
          "UnaryToNary"
        ],
        "writer": {
          "saveMode": "Append",
          "tableName": "",
          "partitionBy": ""
        },
        "uiConfiguration": {
          "position": {
            "x": 723,
            "y": 20
          }
        },
        "configuration": {
          "waterMark": "",
          "whenError": "Error",
          "availability": "1m",
          "dimensions": [
            {
              "name": "id"
            }
          ],
          "partitions": "",
          "timeoutKey": "",
          "operators": [
            {
              "inputField": "id",
              "name": "idcube",
              "classType": "Count"
            }
          ]
        },
        "supportedEngines": [],
        "executionEngine": "Streaming"
      }
    ],
    "edges": [
      {
        "origin": "tabletest",
        "destination": "Postgres"
      },
      {
        "origin": "Kafka",
        "destination": "Print"
      },
      {
        "origin": "Kafka",
        "destination": "tabletest"
      },
      {
        "origin": "Kafka",
        "destination": "Cube"
      },
      {
        "origin": "Cube",
        "destination": "Postgres"
      }
    ]
  },
  "executionEngine": "Streaming",
  "uiSettings": {
    "position": {
      "x": -22,
      "y": 44,
      "k": 1
    }
  },
  "lastUpdateDate": "2018-04-02T17:38:58Z",
  "version": 0,
  "group": {
    "id": "940800b2-6d81-44a8-84d9-26913a2faea4",
    "name": "/home"
  },
  "status": {
    "id": "56d54069-6844-4131-927b-4321a77fa9ed",
    "status": "Started",
    "statusInfo": "Workflow started correctly",
    "lastExecutionMode": "marathon",
    "lastUpdateDate": "2018-04-02T17:39:18Z",
    "sparkURI": "https://sparta.nightly.labs.stratio.com/workflows-sparta-server/home/kafka-postgres/kafka-postgres-v0/",
    "lastUpdateDateWorkflow": "2018-04-02T17:38:58Z"
  }
}