{
  "workflows": [
    {
      "id": "c76053f2-8153-45cf-a073-29288cf8d5be",
      "name": "kafka-postgres",
      "description": "Automatic Workflow kafka-postgres",
      "settings": {
        "global": {
          "executionMode": "marathon",
          "userPluginsJars": [],
          "initSqlSentences": [],
          "addAllUploadedPlugins": true
        },
        "streamingSettings": {
          "window": "2s",
          "remember": "",
          "blockInterval": "100ms",
          "checkpointSettings": {
            "checkpointPath": "sparta/checkpoint",
            "enableCheckpointing": true,
            "autoDeleteCheckpoint": true,
            "addTimeToCheckpointPath": false
          }
        },
        "sparkSettings": {
          "master": "mesos://leader.mesos:5050",
          "sparkKerberos": true,
          "sparkDataStoreTls": true,
          "sparkMesosSecurity": true,
          "submitArguments": {
            "userArguments": [],
            "deployMode": "client",
            "driverJavaOptions": "-XX:+UseConcMarkSweepGC"
          },
          "sparkConf": {
            "sparkResourcesConf": {
              "coresMax": "1",
              "executorMemory": "2G",
              "executorCores": "1",
              "driverCores": "1",
              "driverMemory": "2G",
              "mesosExtraCores": "",
              "localityWait": "100",
              "taskMaxFailures": "8",
              "sparkMemoryFraction": "0.6"
            },
            "userSparkConf": [],
            "coarse": true,
            "sparkUser": "",
            "sparkLocalDir": "/opt/spark/dist",
            "executorExtraJavaOptions": "-XX:+UseConcMarkSweepGC"
          }
        },
        "errorsManagement": {
          "genericErrorManagement": {
            "whenError": "Error"
          },
          "transformationStepsManagement": {
            "whenError": "Error",
            "whenRowError": "RowError",
            "whenFieldError": "FieldError"
          },
          "transactionsManagement": {
            "sendToOutputs": [],
            "sendStepData": false,
            "sendPredecessorsData": false,
            "sendInputData": true
          }
        }
      },
      "pipelineGraph": {
        "nodes": [
          {
            "name": "Kafka",
            "stepType": "Input",
            "className": "KafkaInputStep",
            "classPrettyName": "Kafka",
            "arity": [
              "NullaryToNary"
            ],
            "writer": {
              "saveMode": "Append",
              "tableName": "",
              "partitionBy": ""
            },
            "uiConfiguration": {
              "position": {
                "x": 289,
                "y": 172
              }
            },
            "configuration": {
              "locationStrategy": "preferconsistent",
              "inputOptions": "[]",
              "topics": [
                {
                  "topic": "idtopic"
                }
              ],
              "auto.offset.reset": "latest",
              "partition.assignment.strategy": "range",
              "value.deserializer.inputFormat": "JSON",
              "tlsEnabled": false,
              "group.id": "sparta_2",
              "bootstrap.servers": [
                {
                  "port": "9092",
                  "host": "broker-0001.kafka-sec.mesos"
                }
              ],
              "enable.auto.commit": false,
              "value.deserializer.json.schema.fromRow": true,
              "storeOffsetInKafka": true
            }
          },
          {
            "name": "tabletest",
            "stepType": "Transformation",
            "className": "TriggerTransformStepStream",
            "classPrettyName": "Trigger",
            "arity": [
              "BinaryToNary",
              "UnaryToNary"
            ],
            "writer": {
              "saveMode": "Append",
              "tableName": "",
              "partitionBy": ""
            },
            "uiConfiguration": {
              "position": {
                "x": 729,
                "y": 322
              }
            },
            "configuration": {
              "sql": "select id from Kafka"
            }
          },
          {
            "name": "Postgres",
            "stepType": "Output",
            "className": "PostgresOutputStep",
            "classPrettyName": "Postgres",
            "arity": [
              "NullaryToNullary",
              "NaryToNullary"
            ],
            "writer": {
              "saveMode": "Append"
            },
            "uiConfiguration": {
              "position": {
                "x": 972,
                "y": 204
              }
            },
            "configuration": {
              "errorSink": false,
              "url": "jdbc:postgresql://pg-0001-postgrestls.service.paas.labs.stratio.com:5432/postgres?user=sparta-server",
              "postgresSaveMode": "STATEMENT",
              "batchsize": "1000",
              "isolationLevel": "READ_UNCOMMITTED",
              "tlsEnabled": true,
              "driver": "",
              "schemaFromDatabase": false,
              "saveOptions": "[]"
            }
          },
          {
            "name": "Print",
            "stepType": "Output",
            "className": "PrintOutputStep",
            "classPrettyName": "Print",
            "arity": [
              "NaryToNullary"
            ],
            "writer": {
              "saveMode": "Append"
            },
            "uiConfiguration": {
              "position": {
                "x": 464,
                "y": -25
              }
            },
            "configuration": {
              "printSchema": true,
              "logLevel": "warn",
              "printMetadata": true,
              "printData": true
            }
          },
          {
            "name": "Cube",
            "stepType": "Transformation",
            "className": "CubeTransformStep",
            "classPrettyName": "Cube",
            "arity": [
              "UnaryToNary"
            ],
            "writer": {
              "saveMode": "Append",
              "tableName": "",
              "partitionBy": ""
            },
            "uiConfiguration": {
              "position": {
                "x": 723,
                "y": 20
              }
            },
            "configuration": {
              "waterMark": "",
              "whenError": "Error",
              "availability": "1m",
              "dimensions": [
                {
                  "name": "id"
                }
              ],
              "partitions": "",
              "timeoutKey": "",
              "operators": [
                {
                  "inputField": "id",
                  "name": "idcube",
                  "classType": "Count"
                }
              ]
            }
          }
        ],
        "edges": [
          {
            "origin": "tabletest",
            "destination": "Postgres"
          },
          {
            "origin": "Kafka",
            "destination": "Print"
          },
          {
            "origin": "Kafka",
            "destination": "tabletest"
          },
          {
            "origin": "Kafka",
            "destination": "Cube"
          },
          {
            "origin": "Cube",
            "destination": "Postgres"
          }
        ]
      },
      "executionEngine": "Streaming",
      "uiSettings": {
        "position": {
          "x": -22,
          "y": 44,
          "k": 1
        }
      },
      "creationDate": "2018-02-13T15:16:31Z",
      "lastUpdateDate": "2018-02-08T15:37:37Z",
      "version": 0,
      "group": {
        "id": "940800b2-6d81-44a8-84d9-26913a2faea4",
        "name": "/home"
      },
      "status": {
        "id": "c76053f2-8153-45cf-a073-29288cf8d5be",
        "status": "NotStarted",
        "creationDate": "2018-02-13T15:16:31Z"
      }
    },
    {
      "id": "3895acc8-8396-4303-a745-7adcb8718870",
      "name": "testinput-kafka",
      "description": "Automatic Workflow testinput kafka 400ev",
      "settings": {
        "global": {
          "executionMode": "marathon",
          "userPluginsJars": [],
          "initSqlSentences": [],
          "addAllUploadedPlugins": true
        },
        "streamingSettings": {
          "window": "2s",
          "remember": "",
          "blockInterval": "100ms",
          "checkpointSettings": {
            "checkpointPath": "sparta/checkpoint",
            "enableCheckpointing": true,
            "autoDeleteCheckpoint": true,
            "addTimeToCheckpointPath": false
          }
        },
        "sparkSettings": {
          "master": "mesos://leader.mesos:5050",
          "sparkKerberos": true,
          "sparkDataStoreTls": true,
          "sparkMesosSecurity": true,
          "submitArguments": {
            "userArguments": [],
            "deployMode": "client",
            "driverJavaOptions": "-XX:+UseConcMarkSweepGC"
          },
          "sparkConf": {
            "sparkResourcesConf": {
              "coresMax": "1",
              "executorMemory": "2G",
              "executorCores": "1",
              "driverCores": "1",
              "driverMemory": "2G",
              "mesosExtraCores": "",
              "localityWait": "100",
              "taskMaxFailures": "8",
              "sparkMemoryFraction": "0.6"
            },
            "userSparkConf": [],
            "coarse": true,
            "sparkUser": "",
            "sparkLocalDir": "/opt/spark/dist",
            "executorExtraJavaOptions": "-XX:+UseConcMarkSweepGC"
          }
        },
        "errorsManagement": {
          "genericErrorManagement": {
            "whenError": "Error"
          },
          "transformationStepsManagement": {
            "whenError": "Error",
            "whenRowError": "RowError",
            "whenFieldError": "FieldError"
          },
          "transactionsManagement": {
            "sendToOutputs": [],
            "sendStepData": false,
            "sendPredecessorsData": false,
            "sendInputData": true
          }
        }
      },
      "pipelineGraph": {
        "nodes": [
          {
            "name": "Test",
            "stepType": "Input",
            "className": "TestInputStepStream",
            "classPrettyName": "Test",
            "arity": [
              "NullaryToNary"
            ],
            "writer": {
              "saveMode": "Append",
              "tableName": "",
              "partitionBy": ""
            },
            "description": "Json with ID",
            "uiConfiguration": {
              "position": {
                "x": 476,
                "y": 234
              }
            },
            "configuration": {
              "maxNumbEvents": "400",
              "eventType": "STRING",
              "outputField": "raw",
              "event": "{\"id\":\"550\"}",
              "numEvents": "400"
            }
          },
          {
            "name": "JsonPath",
            "stepType": "Transformation",
            "className": "JsonPathTransformStepStream",
            "classPrettyName": "JsonPath",
            "arity": [
              "UnaryToNary"
            ],
            "writer": {
              "saveMode": "Append",
              "tableName": "",
              "partitionBy": ""
            },
            "uiConfiguration": {
              "position": {
                "x": 729,
                "y": 234
              }
            },
            "configuration": {
              "queries": [
                {
                  "field": "id",
                  "query": "$.id",
                  "type": "string"
                }
              ],
              "whenError": "Error",
              "supportNullValues": true,
              "fieldsPreservationPolicy": "REPLACE",
              "inputField": "raw"
            }
          },
          {
            "name": "Kafka",
            "stepType": "Output",
            "className": "KafkaOutputStep",
            "classPrettyName": "Kafka",
            "arity": [
              "NaryToNullary"
            ],
            "writer": {
              "saveMode": "Append"
            },
            "description": "Kafka Output",
            "uiConfiguration": {
              "position": {
                "x": 1239,
                "y": 234
              }
            },
            "configuration": {
              "value.serializer.outputFormat": "JSON",
              "tlsEnabled": true,
              "security.protocol": "PLAINTEXT",
              "bootstrap.servers": [
                {
                  "host": "broker-0001.kafka-sec.mesos",
                  "port": "9092"
                }
              ],
              "acks": "0",
              "ssl.client.auth": "required",
              "saveOptions": "[]",
              "keySeparator": ",",
              "batch.size": "200"
            }
          },
          {
            "name": "idtable",
            "stepType": "Transformation",
            "className": "TriggerTransformStepStream",
            "classPrettyName": "Trigger",
            "arity": [
              "BinaryToNary",
              "UnaryToNary"
            ],
            "writer": {
              "saveMode": "Append",
              "tableName": "idtopic",
              "partitionBy": ""
            },
            "uiConfiguration": {
              "position": {
                "x": 954,
                "y": 234
              }
            },
            "configuration": {
              "sql": "select id from JsonPath"
            }
          }
        ],
        "edges": [
          {
            "origin": "Test",
            "destination": "JsonPath"
          },
          {
            "origin": "JsonPath",
            "destination": "idtable"
          },
          {
            "origin": "idtable",
            "destination": "Kafka"
          }
        ]
      },
      "executionEngine": "Streaming",
      "uiSettings": {
        "position": {
          "x": -216,
          "y": -1,
          "k": 1
        }
      },
      "creationDate": "2018-02-13T15:17:25Z",
      "lastUpdateDate": "2018-01-11T08:20:12Z",
      "version": 0,
      "group": {
        "id": "940800b2-6d81-44a8-84d9-26913a2faea4",
        "name": "/home"
      },
      "status": {
        "id": "3895acc8-8396-4303-a745-7adcb8718870",
        "status": "NotStarted",
        "creationDate": "2018-02-13T15:17:25Z"
      }
    }
  ],
  "templates": [],
  "groups": [
    {
      "id": "940800b2-6d81-44a8-84d9-26913a2faea4",
      "name": "/home"
    }
  ],
  "envVariables": [
    "DEFAULT_OUTPUT_FIELD",
    "DEFAULT_DELIMITER",
    "CROSSDATA_ZOOKEEPER_CONNECTION",
    "CROSSDATA_ZOOKEEPER_PATH",
    "KAFKA_BROKER_HOST",
    "KAFKA_BROKER_PORT",
    "KAFKA_GROUP_ID",
    "WEBSOCKET_URL",
    "CASSANDRA_HOST",
    "CASSANDRA_PORT",
    "CASSANDRA_KEYSPACE",
    "CASSANDRA_CLUSTER",
    "ES_HOST",
    "ES_PORT",
    "ES_CLUSTER",
    "ES_INDEX_MAPPING",
    "JDBC_URL",
    "POSTGRES_URL",
    "MONGODB_HOST",
    "MONGODB_PORT",
    "MONGODB_DB",
    "REDIS_HOST",
    "REDIS_PORT",
    "SPARTA_CHECKPOINT_PATH",
    "SPARK_STREAMING_WINDOW",
    "SPARK_MASTER",
    "DRIVER_JAVA_OPTIONS",
    "EXECUTOR_EXTRA_JAVA_OPTIONS",
    "SPARK_LOCAL_PATH",
    "SPARK_CORES_MAX",
    "SPARK_EXECUTOR_MEMORY",
    "SPARK_EXECUTOR_CORES",
    "SPARK_DRIVER_CORES",
    "SPARK_DRIVER_MEMORY",
    "SPARK_LOCALITY_WAIT",
    "SPARK_TASK_MAX_FAILURES",
    "SPARK_MEMORY_FRACTION",
    "SPARK_BLOCK_INTERVAL"
  ]
}