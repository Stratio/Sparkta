@rest
Feature: [SPARTA_1277]Unistall Sparta with mustache
  Background: Setup DCOS-CLI
    #Start SSH with DCOS-CLI
    Given I open a ssh connection to '${DCOS_CLI_HOST}' with user 'root' and password 'stratio'
  Scenario: [SPARTA_1277][Scenario-02] Delete a existing policy
    When I run 'echo ${previousWorkflowID}| cut -d'.' -f 2 ' in the ssh connection and save the value in environment variable 'idworkflowDelete'
    And I send a 'DELETE' request to '/policy/!{idworkflowDelete}'
    Then the service response status must be '200'
    When I send a 'GET' request to '/policy/all'
    Then the service response status must be '200' and its response must contain the text '[]'

  Scenario:  Scenario: [SPARTA-1182][Scenario-03] Remove workflow
    When  I run 'dcos marathon app remove /sparta/${DCOS_SERVICE_NAME}/workflows/${WORKFLOW}' in the ssh connection
    Then in less than '300' seconds, checking each '10' seconds, the command output 'dcos task | grep ${DCOS_SERVICE_NAME} | wc -l' contains '0'
