<!--
    © 2017 Stratio Big Data Inc., Sucursal en España. All rights reserved.
    This software – including all its source code – contains proprietary
    information of Stratio Big Data Inc., Sucursal en España and
    may not be revealed, sold, transferred, modified, distributed or
    otherwise made available, licensed or sublicensed to third parties;
    nor reverse engineered, disassembled or decompiled, without express
    written authorization from Stratio Big Data Inc., Sucursal en España.
-->

<st-fullscreen-layout title="{{entityFormModel.stepType}} - {{currentName}}">
   <div class="st-fullscreen-layout-buttons">
      <button class="button button-secondary-gray cancel-button" (click)="cancelEdition()" id="cancel-edit-node">
            <span>{{'WIZARD.CANCEL' | translate}}</span>
      </button>
      <button class="button button-primary" (click)="saveForm()" id="save-node-button">
            <span>{{'WIZARD.SAVE' | translate}}</span>
      </button>
   </div>
   <div class="st-fullscreen-layout-content">
      <div class="container node-edition">
         <form #entityForm="ngForm" class="form-group row" novalidate autocomplete="off" (ngSubmit)="saveForm()">
            <div class="col-sm-12">
               <st-horizontal-tabs class="entity-categories" *ngIf="config.editionType.stepType !== 'Output'" [options]="options" [qaTag]="qaTag"
                  (changedOption)="changeFormOption($event)">
               </st-horizontal-tabs>
               <div class="row" [hidden]="!(config.editionType.stepType === 'Output' || activeOption === 'Global')">
                  <div class="col-sm-6" [ngClass]="{'error' : validatedName}">
                     <sp-input name="name" (change)="resetValidation()" [(ngModel)]="entityFormModel['name']" label="{{'TEMPLATE_NAME' | translate}} *"
                        fieldType="text" [required]="true" qaTag="input-name" [forceValidations]="submitted" maxLength="30"
                        [errors]="errorsService.errors.inputErrors" class="input-field st-form-field"></sp-input>
                     <div class="st-input-error-message name-validation" *ngIf="validatedName">{{'WIZARD.NODE_NAME_VALIDATION' | translate}}</div>
                  </div>
               </div>
               <div class="row" [hidden]="!(config.editionType.stepType === 'Output' || activeOption === 'Global')">
                  <div class="col-sm-6">
                     <sp-textarea name="description" [(ngModel)]="entityFormModel['description']" label="{{'TEMPLATE_DESCRIPTION' | translate}}"
                        fieldType="text" [required]="false" qaTag="input-name" [forceValidations]="submitted" maxLength="120"
                        [errors]="errorsService.errors.inputErrors" class="input-field st-form-field"></sp-textarea>
                  </div>
               </div>
               <form-generator *ngIf="config.editionType.stepType !== 'Output'" [hidden]="activeOption !== 'Writer'" [forceValidations]="submitted"
                  name="writer" [formData]="writerSettings" [(ngModel)]="entityFormModel.writer"></form-generator>

               <form-generator *ngIf="!isTemplate" [hidden]="!(config.editionType.stepType === 'Output' || activeOption === 'Global')" [forceValidations]="submitted"
                  name="global" [formData]="basicSettings" [(ngModel)]="entityFormModel.configuration"></form-generator>
               <div class="template-data" *ngIf="isTemplate && templateData && activeOption === 'Global'">
                     <div class="egeo-title-medium">Template configuration</div>
                     <div class="advice-params">These are read-only parameters. To edit them, <span class="link" (click)="editTemplate(templateData.id)">go to the Templates section</span>.</div>
                  <form-generator [forceValidations]="submitted" [disabled]="true" [disabledForm]="true"
                        name="global" [formData]="basicSettings" [(ngModel)]="templateData.configuration"></form-generator>
               </div>
            </div>
         </form>
      </div>
   </div>
</st-fullscreen-layout>
