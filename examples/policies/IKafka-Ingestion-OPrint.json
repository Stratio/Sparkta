{
  "name": "sales-demo-with-geo-parser",
  "description": "sales-demo-with-geo-parser",
  "sparkStreamingWindow": 2000,
  "input": {
    "name": "in-kafka",
    "type": "Kafka",
    "configuration": {
      "topics": [{
        "topic": "detector",
        "partition": "1"
      }],
      "bootstrap.servers": [{
        "host": "localhost",
        "port": "2181"
      }],
      "group.id": "testgroup4"
    }
  },
  "transformations": [
    {
      "name": "ingestion-parser",
      "order": 1,
      "type": "Ingestion",
      "outputFields": [
        {"name":"order_id"},
        {"name":"day_time_zone"},
        {"name":"eventDatetime"},
        {"name":"client_id"},
        {"name":"payment_method"},
        {"name":"latitude"},
        {"name":"longitude"},
        {"name":"credit_card"},
        {"name":"shopping_center"},
        {"name":"channel"},
        {"name":"city"},
        {"name":"country"},
        {"name":"employee"},
        {"name":"total_amount"},
        {"name":"total_products"},
        {"name":"order_size"},
        {"name":"lines"}
      ],
      "configuration": {}
    },
    {
      "name": "geo-parser",
      "order": 2,
      "type": "Geo",
      "inputField": "_",
      "outputFields": [
        {"name":"geo"}
      ],
      "configuration": {
        "latitude": "latitude",
        "longitude": "longitude"
      }
    }, {
      "name": "timestamp",
      "order": 3,
      "type": "DateTime",
      "outputFields": [{
        "name": "ts"
      }],
      "configuration": {
        "inputFormat": "autoGenerated"
      }
    }

  ],
  "cubes": [{
    "name": "heatMapPerActivity",
    "writer": {
      "outputs" : ["out-print"]
    },
    "dimensions": [{
      "name": "geo",
      "field": "geo",
      "type": "GeoHash",
      "precision": "precision12"
    },
      {
        "name": "ts",
        "field": "ts",
        "type": "DateTime",
        "precision": "day",
        "computeLast": "15d"
      }],
    "operators": [{
      "name": "sum_tp",
      "type": "Sum",
      "configuration": {
        "inputField": "total_products"
      }
    }]
  }],
  "outputs": [
    {
      "name": "out-print",
      "type": "Print",
      "configuration": {}
    }
  ]
}